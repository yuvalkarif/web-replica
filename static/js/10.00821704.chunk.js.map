{"version":3,"sources":["services/firebase.js","Components/Header/photos/Karifgram.png","Components/SignUpPage/SignUpPage.styles.js","Components/SignUpPage/index.js"],"names":["doesUserNameExist","username","a","firebase","firestore","collection","where","get","result","docs","map","user","data","length","getUserByUserId","userId","item","docId","id","getUserByUsername","getSuggestions","following","limit","results","filter","profile","includes","updateLoggedInUserFollowing","loggedInUserDocId","profileId","isFollowingProfile","doc","update","FieldValue","arrayRemove","arrayUnion","updateFollowedUserFollowers","profileDocId","followers","getPhotos","userFollowedPhotos","photo","Promise","all","userLikedPhoto","likes","photosWithUserDetails","getPostsByUserId","getPhotoByPhotoId","photoId","getProfilePictureByName","displayName","profilePic","getLikedPhoto","getUserWithDocId","Wrapper","styled","div","LogoImg","img","LoginForm","form","SubmitButton","button","props","disabled","Bottom","ErrorMessage","SignUpPage","history","useHistory","useContext","FirebaseContext","useState","userName","setUserName","fullName","setFullName","emailAddress","setEmailAddress","password","setPassword","error","setError","isInvalid","handleSignUp","event","preventDefault","auth","createUserWithEmailAndPassword","createdUserResult","updateProfile","add","uid","toLowerCase","dateCreated","Date","now","push","ROUTES","useEffect","document","title","src","Logo","onSubmit","method","type","placeholder","onChange","target","value","toString","to"],"mappings":"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","file":"static/js/10.00821704.chunk.js","sourcesContent":["import { firebase, FieldValue } from \"../Lib/firebase\";\n\nexport async function doesUserNameExist(username) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"username\", \"==\", username)\n    .get();\n\n  return result.docs.map((user) => user.data().length > 0);\n}\n\nexport async function getUserByUserId(userId) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"userId\", \"==\", userId)\n    .get();\n  const user = result.docs.map((item) => ({\n    ...item.data(),\n    docId: item.id,\n  }));\n  return user;\n}\nexport async function getUserByUsername(username) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"username\", \"==\", username)\n    .get();\n  const user = result.docs.map((item) => ({\n    ...item.data(),\n    docId: item.id,\n  }));\n  return user;\n}\n\nexport async function getSuggestions(userId, following) {\n  const results = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"userId\", \"!=\", userId)\n    .limit(10)\n    .get();\n\n  return results.docs\n    .map((user) => ({ ...user.data(), docId: user.id }))\n    .filter((profile) => profile.userId && !following.includes(profile.userId));\n}\n\nexport async function updateLoggedInUserFollowing(\n  loggedInUserDocId,\n  profileId,\n  isFollowingProfile\n) {\n  return firebase\n    .firestore()\n    .collection(\"users\")\n    .doc(loggedInUserDocId)\n    .update({\n      following: isFollowingProfile\n        ? FieldValue.arrayRemove(profileId)\n        : FieldValue.arrayUnion(profileId),\n    });\n}\nexport async function updateFollowedUserFollowers(\n  profileDocId,\n  loggedInUserDocId,\n  isFollowingProfile\n) {\n  return firebase\n    .firestore()\n    .collection(\"users\")\n    .doc(profileDocId)\n    .update({\n      followers: isFollowingProfile\n        ? FieldValue.arrayRemove(loggedInUserDocId)\n        : FieldValue.arrayUnion(loggedInUserDocId),\n    });\n}\n\nexport async function getPhotos(userId, following) {\n  const result = await firebase\n    .firestore()\n    .collection(\"photos\")\n    .where(\"userId\", \"in\", following)\n    .get();\n  const userFollowedPhotos = result.docs.map((photo) => ({\n    ...photo.data(),\n    docId: photo.id,\n  }));\n  const photosWithUserDetails = await Promise.all(\n    userFollowedPhotos.map(async (photo) => {\n      let userLikedPhoto = false;\n      if (photo.likes.includes(userId)) {\n        userLikedPhoto = true;\n      }\n      const user = await getUserByUserId(photo.userId);\n      const { username } = user[0];\n      return { username, ...photo, userLikedPhoto };\n    })\n  );\n  return photosWithUserDetails;\n}\n\nexport async function getPostsByUserId(userId) {\n  const result = await firebase\n    .firestore()\n    .collection(\"photos\")\n    .where(\"userId\", \"==\", userId)\n    .get();\n\n  return result.docs.map((photo) => photo.data());\n}\n\nexport async function getPhotoByPhotoId(photoId) {\n  const result = await firebase\n    .firestore()\n    .collection(\"photos\")\n    .where(\"photoId\", \"==\", photoId)\n    .get();\n\n  return result.docs.map((photo) => ({\n    ...photo.data(),\n    docId: photo.id,\n  }));\n}\n\nexport async function getProfilePictureByName(displayName) {\n  const [result] = await getUserByUsername(displayName);\n  return result.profilePic;\n}\n\nexport function getLikedPhoto(photo, userId) {\n  let userLikedPhoto = false;\n  if (photo.likes.includes(userId)) {\n    userLikedPhoto = true;\n  }\n  const newPhoto = { ...photo, userLikedPhoto: userLikedPhoto };\n\n  return newPhoto;\n}\n\nexport async function getUserWithDocId(userId) {\n  const result = await firebase\n    .firestore()\n    .collection(\"users\")\n    .where(\"userId\", \"==\", userId)\n    .get();\n\n  const [user] = result.docs.map((user) => ({\n    ...user.data(),\n    docId: user.id,\n  }));\n\n  return user;\n}\n","export default __webpack_public_path__ + \"static/media/Karifgram.33790cf2.png\";","import styled from \"styled-components\";\n\nexport const Wrapper = styled.div`\n  display: flex;\n  margin: 0 auto;\n  width: 248px;\n  border: 1.5px solid var(--lightColor);\n  padding: 0 2.75rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  background-color: white;\n  margin-top: 8rem;\n  padding-bottom: 1.5rem;\n`;\n\nexport const LogoImg = styled.img`\n  width: 156px;\n  height: auto;\n  margin: 2rem 0;\n`;\n\nexport const LoginForm = styled.form`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  font-family: inherit;\n  width: 100%;\n  input {\n    color: var(--darkColor);\n    background-color: var(--bgColor);\n    border: 1.5px solid var(--lightColor);\n    border-radius: 3px;\n    padding: 0.35rem 0;\n    margin-bottom: 0.5rem;\n    width: 100%;\n    padding-inline: 0.4rem;\n  }\n`;\n\nexport const SubmitButton = styled.button`\n  background-color: var(--blueColor);\n  color: var(--bgColor);\n  border: none;\n  border-radius: 4px;\n  padding: 0.35rem 0;\n  font-family: inherit;\n  font-weight: 700;\n  width: 106.5%;\n  font-size: 0.9rem;\n  opacity: ${(props) => (props.disabled ? \"50%\" : \"100%\")};\n  cursor: ${(props) => (props.disabled ? \"normal\" : \"pointer\")};\n  margin-top: 0.35rem;\n`;\n\nexport const Bottom = styled.div`\n  font-size: 0.9rem;\n  font-weight: 400;\n  margin: 0 auto;\n  width: 248px;\n  border: 1.5px solid var(--lightColor);\n  padding: 1rem 2.75rem;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  background-color: white;\n  margin-top: 2rem;\n  a {\n    text-decoration: none;\n    color: var(--blueColor);\n    margin-left: 0.35rem;\n    font: inherit;\n    font-weight: 500;\n  }\n`;\nexport const ErrorMessage = styled.div`\n  color: red;\n  font-size: 0.75rem;\n  text-align: center;\n  margin-bottom: 1.5rem;\n`;\n","import React from \"react\";\nimport { useState, useEffect, useContext } from \"react\";\nimport {\n  Bottom,\n  ErrorMessage,\n  LoginForm,\n  SubmitButton,\n  Wrapper,\n  LogoImg,\n} from \"./SignUpPage.styles\";\nimport Logo from \"./../Header/photos/Karifgram.png\";\nimport { useHistory } from \"react-router-dom\";\n\nimport FirebaseContext from \"../../Context/firebase\";\nimport * as ROUTES from \"../../constants/routes\";\nimport { Link } from \"react-router-dom\";\nimport { doesUserNameExist } from \"../../services/firebase\";\n\nconst SignUpPage = () => {\n  const history = useHistory();\n  const { firebase } = useContext(FirebaseContext);\n\n  const [userName, setUserName] = useState(\"\");\n  const [fullName, setFullName] = useState(\"\");\n  const [emailAddress, setEmailAddress] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n\n  const [error, setError] = useState(``);\n\n  const isInvalid = password === \"\" || emailAddress === \"\";\n\n  const handleSignUp = async (event) => {\n    event.preventDefault();\n    const usernameExists = await doesUserNameExist(userName);\n    if (!usernameExists.length) {\n      try {\n        const createdUserResult = await firebase\n          .auth()\n          .createUserWithEmailAndPassword(emailAddress, password);\n        //auth\n        await createdUserResult.user.updateProfile({ displayName: userName });\n        //firebase user collection\n        await firebase\n          .firestore()\n          .collection(\"users\")\n          .add({\n            userId: createdUserResult.user.uid,\n            username: userName.toLowerCase(),\n            fullName,\n            emailAddress: emailAddress.toLowerCase(),\n            following: [\"bmxcUk2TvAYrbmvPisqMr8stjFG2\"],\n            dateCreated: Date.now(),\n          });\n\n        history.push(ROUTES.DASHBOARD);\n      } catch (error) {\n        setFullName(\"\");\n        setPassword(\"\");\n        setEmailAddress(\"\");\n        setUserName(\"\");\n      }\n    } else {\n      setError(\"Username is already taken, please try another.\");\n    }\n  };\n\n  useEffect(() => {\n    document.title = \"SignUp - Instagram\";\n  });\n  return (\n    <>\n      <Wrapper>\n        <LogoImg src={Logo}></LogoImg>\n        {error && <ErrorMessage>{error}</ErrorMessage>}\n        <LoginForm onSubmit={handleSignUp} method=\"POST\">\n          <input\n            aria-label=\"Enter full name\"\n            type=\"text\"\n            placeholder=\"Full Name\"\n            onChange={({ target }) => setFullName(target.value.toString())}\n            value={fullName}\n          />\n          <input\n            aria-label=\"Enter Username\"\n            type=\"text\"\n            placeholder=\"Username\"\n            onChange={({ target }) => setUserName(target.value.toString())}\n            value={userName}\n          />\n          <input\n            aria-label=\"Enter your email address\"\n            type=\"text\"\n            placeholder=\"Email address\"\n            onChange={({ target }) => setEmailAddress(target.value.toString())}\n            value={emailAddress}\n          />\n          <input\n            aria-label=\"Enter your password\"\n            type=\"password\"\n            placeholder=\"Password\"\n            onChange={({ target }) => setPassword(target.value)}\n            value={password}\n          />\n          <SubmitButton disabled={isInvalid} type=\"submit\">\n            Sign Up\n          </SubmitButton>\n        </LoginForm>\n      </Wrapper>\n\n      <Bottom>\n        <div>Have an Account?</div> <Link to={ROUTES.LOGIN}>Log In</Link>\n      </Bottom>\n    </>\n  );\n};\n\nexport default SignUpPage;\n"],"sourceRoot":""}